<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crop Recommender - Agriculture Assistant</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<header class="navbar">
    <div class="container">
        <a href="index.html" class="logo">Agri-Assistant ðŸŒ±</a>
        <nav>
            <a href="crop-data.html">Crop Data</a>
            <a href="recommender.html">Crop Recommender</a>
            <a href="techniques.html">Techniques</a>
            <a href="schemes.html">Schemes</a>
            <a href="diseases.html">Diseases</a>
            <a href="npk-advisor.html">NPK Advisor</a>
            <a href="contact.html">Contact</a>
        </nav>
    </div>
</header>

<main class="container">
    <h2>Crop Recommender</h2>
    <p>Enter your soil and climate conditions to get an intelligent crop recommendation.</p>

    <form id="recommenderForm">
        <div><label for="n">Nitrogen (N) content in soil:</label><input type="number" id="n" required step="any"></div>
        <div><label for="p">Phosphorous (P) content in soil:</label><input type="number" id="p" required step="any"></div>
        <div><label for="k">Potassium (K) content in soil:</label><input type="number" id="k" required step="any"></div>
        <div><label for="temperature">Temperature (Â°C):</label><input type="number" id="temperature" required step="any"></div>
        <div><label for="humidity">Relative Humidity (%):</label><input type="number" id="humidity" required step="any"></div>
        <div><label for="ph">pH value of soil:</label><input type="number" id="ph" required step="any"></div>
        <div><label for="rainfall">Rainfall (mm):</label><input type="number" id="rainfall" required step="any"></div>
        <button type="submit">Get Recommendation</button>
    </form>

    <div id="resultDiv"
         class="card"
         style="margin-top:30px; text-align:center; display:none;">
    </div>
</main>

<footer class="footer">
    <div class="container">
        <p>&copy; 2025 Agriculture Assistant. All Rights Reserved.</p>
    </div>
</footer>

<div class="creator-credit">Created by Sricharan, Ramcharan and Suhel</div>

<script>
    // Always use Vercel API
    const API_BASE = "/api";

    const form = document.getElementById("recommenderForm");
    const resultDiv = document.getElementById("resultDiv");

    form.addEventListener("submit", async (event) => {
        event.preventDefault();

        resultDiv.style.display = "block";
        resultDiv.innerHTML = "<p>Getting recommendation...</p>";

        const formData = {
            N: parseFloat(document.getElementById("n").value),
            P: parseFloat(document.getElementById("p").value),
            K: parseFloat(document.getElementById("k").value),
            temperature: parseFloat(document.getElementById("temperature").value),
            humidity: parseFloat(document.getElementById("humidity").value),
            ph: parseFloat(document.getElementById("ph").value),
            rainfall: parseFloat(document.getElementById("rainfall").value)
        };

        try {
            const response = await fetch(`${API_BASE}/recommend`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(formData)
            });

            if (!response.ok) throw new Error("Prediction request failed");

            const result = await response.json();

            resultDiv.innerHTML = `
                <h3>Recommended Crop:</h3>
                <p style="font-size:1.5rem; font-weight:bold; color:#16a34a;">
                    ${result.recommended?.[0] ?? "No result"}
                </p>
            `;

        } catch (error) {
            console.error("Error:", error);
            resultDiv.innerHTML =
                '<p style="color:red;">Could not get a recommendation. Please ensure the backend API is working.</p>';
        }
    });
</script>

</body>
</html>
